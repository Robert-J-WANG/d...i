## ç”µå½±åˆ—è¡¨æŸ¥è¯¢

apiåœ°å€ï¼šhttps://developer.themoviedb.org/reference/search-movie

1. åˆ›å»ºæŸ¥è¯¢ç”µå½±çš„API

    1. é€»è¾‘æ€è·¯ï¼šæ ¹æ®å…³é”®å­—æŸ¥è¯¢ç”µå½±ï¼Œå¦‚æœå…³é”®å­—ä¸ºç©ºæ—¶ï¼Œåˆ™è¿”å›æ­£åœ¨çƒ­æ’­çš„ç”µå½±åˆ—è¡¨ã€‚å¦åˆ™ï¼Œæ ¹æ®å…³é”®å­—æœç´¢

    2. serveræ–‡ä»¶å¤¹çš„movieAPIæ–‡ä»¶ä¸­æ·»åŠ æ–°çš„æ–¹æ³•**getNowPlayingMovies**ï¼Œ è·å–æ­£åœ¨çƒ­æ’­çš„ç”µå½±åˆ—è¡¨

         ```js
         /**
          * è·å–æ­£åœ¨ä¸Šæ˜ çš„ç”µå½±åˆ—è¡¨
          * @param {*} page æ˜¾ç¤ºå½“å‰çš„é¡µæ•°-é»˜è®¤å€¼æ˜¯1
          * å¯é€‰å‚æ•°ï¼šlanguageï¼Œ region
          * @returns
          */
         export async function getNowPlayingMovies(page=1) {
           // å…ˆåœ¨package.jsonä¸­é…ç½®ä»£ç†ï¼Œæ–¹ä¾¿ç»´æŠ¤æ›´æ”¹
           const res = await axios.get("/3/movie/now_playing", {
             params: { page },
             headers: { Authorization: "Bearer " + TOKEN },
           });
           return res.data;
         }
         ```

    3. serveræ–‡ä»¶å¤¹çš„movieAPIæ–‡ä»¶ä¸­æ·»åŠ æ–°çš„æ–¹æ³•**searchMovies**, æ ¹æ®å…³é”®å­—æœç´¢ç”µå½±

        ```js
        /**
         * æ ¹æ®å…³é”®å­—æœç´¢ç”µå½±
         * @param {*} page å½“å‰çš„æ˜¾ç¤ºçš„é¡µç 
         * @param {*} query è¾“å…¥æœç´¢çš„å…³é”®å­—
         * @param {*} language è¯­è¨€ï¼ˆå¯é€‰ï¼‰
         * @param {*} region åœ°åŒºï¼ˆå¯é€‰ï¼‰
         * @returns
         */
        export async function searchMovies(page = 1, query, language, region) {
          if (query) {
            const res = await axios.get("https://api.themoviedb.org/3/search/movie", {
              params: {
                page,
                query,
                language,
                region,
              },
              headers: { Authorization: "Bearer " + TOKEN },
            });
            return res.data;
          } else {
            return await getNowPlayingMovies(page);
          }
        }
        ```

2. ç¼–å†™æŸ¥è¯¢ç»„ä»¶ï¼Œä½¿ç”¨æ–‡æœ¬æ¡†ï¼Œè·å–æŸ¥è¯¢æ•°æ®

    1. componentæ–‡ä»¶å¤¹ä¸‹åˆ›å»ºç»„ä»¶MovieSearchBar

        ```jsx
        import React, { Component } from "react";
        import "./index.css";
        
        export default class MovieSearchBar extends Component {
          // state = {
          //   query: "",
          //   langage: "en-US",
          //   region: "",
          // };
          constructor(props) {
            super(props);
            const defaultState = {
              query: "",
              langage: "en-US",
              region: "",
            };
            // æ··åˆä¸€ä¸‹çŠ¶æ€ï¼šå¦‚æœæ²¡æœ‰ä¼ é€’è¿‡æ¥çš„propsé‡Œçš„defaultValueï¼Œåˆ™ä½¿ç”¨defaultStateï¼Œå¦åˆ™ï¼Œå°†ä¼ é€’è¿‡æ¥çš„defaultValueä¸defaultStateæ··åˆï¼Œç»“æœè®¾ç½®ä¸ºåˆå§‹çŠ¶æ€å€¼
            // è¿™æ ·å°±å¯ä»¥åœ¨ä½¿ç”¨MovieSearchBarç»„ä»¶æ—¶ï¼Œè®¾ç½®é»˜è®¤å±æ€§äº†
            this.state = Object.assign({}, defaultState, props.defaultValue);
          }
          handleSearch = () => {
            // æŠ›å‡ºäº‹ä»¶
            if (this.props.onSearch) {
              this.props.onSearch(this.state);
            }
          };
        
          render() {
            return (
              <div className="searchBar">
                <h2 className="searchTitle">Search Movies</h2>
                <div className="searchForm">
                  <span>
                    Keywords:{" "}
                    <input
                      type="text"
                      value={this.state.query}
                      onChange={(e) => {
                        this.setState({ ...this.state, query: e.target.value });
                      }}
                    />
                  </span>
                  <span>
                    Language(such as "en-US"):{" "}
                    <input
                      type="text"
                      value={this.state.langage}
                      onChange={(e) => {
                        this.setState({ ...this.state, langage: e.target.value });
                      }}
                    />
                  </span>
                  <span>
                    Region(such as "US" ):{" "}
                    <input
                      type="text"
                      value={this.state.region}
                      onChange={(e) => {
                        this.setState({ ...this.state, region: e.target.value });
                      }}
                    />
                  </span>
                  <button onClick={this.handleSearch}>Search</button>
                </div>
              </div>
            );
          }
        }
        
        ```

        

    2. MovieListç»„ä»¶ä¸­ä½¿ç”¨MovieSearchBarï¼Œå¹¶ä¼ é€’å±æ€§defaultValueå’ŒonSearch

        ```jsx
        import React from "react";
        import MovieSearchBar from "../../components/MovieSearchBar";
        
        export default function MovieList() {
          return (
            <div>
              <h1>Movieåˆ—è¡¨é¡µ</h1>
              <MovieSearchBar
                defaultValue={{
                  query: "hello world",
                  langage: "en-US",
                  region: "CN",
                }}
                onSearch={(cond) => {
                  console.log(cond);
                }}
              />
            </div>
          );
        }
        ```
    3. æµ‹è¯•æ•ˆæœ
        ![sdf](./assets/24.png)

3. ç¼–å†™è¡¨æ ¼ç»„ä»¶ï¼Œç”¨äºå±•ç¤ºç”µå½±æ•°æ®

    1. componentæ–‡ä»¶å¤¹ä¸‹åˆ›å»ºç»„ä»¶MovieTable

        ```jsx
        import React from "react";
        import "./index.css";
        
        export default function MovieTable(props) {
          const trs = props.results.map((m) => (
            <tr key={m.id}>
              <td>{m.original_title}</td>
              <td>{m.poster_path}</td>
              <td>{m.original_language}</td>
              <td>{+m.vote_average.toFixed(2)}</td>
              <td>/</td>
            </tr>
          ));
          return (
            <table className="table">
              <thead>
                <tr>
                  <th>Title</th>
                  <th>Poster</th>
                  <th>Language</th>
                  <th>Rate</th>
                  <th>Action</th>
                </tr>
              </thead>
              <tbody>{trs}</tbody>
            </table>
          );
        }
        ```

        

    2. MovieListç»„ä»¶ä¸­ä½¿ç”¨MovieTableï¼Œä¸´æ—¶è°ƒç”¨movieAPIæ–‡ä»¶ä¸­çš„æ–¹æ³•**searchMovies**ï¼Œä½¿ç”¨hooksè·å–æ•°æ®å¹¶ä¼ é€’ç»™ç»„ä»¶MovieTable

        ```jsx
        import React, { useState, useEffect } from "react";
        import MovieSearchBar from "../../components/MovieSearchBar";
        import MovieTable from "../../components/MovieTable";
        import { searchMovies } from "../../server/movieAPI";
        
        export default function MovieList() {
          const [movies, setMovies] = useState([]);
          useEffect(() => {
            searchMovies().then((resp) => setMovies(resp.results));
          }, []);
          return (
            <div>
              <MovieSearchBar
                defaultValue={{
                  query: "hello world",
                  langage: "en-US",
                  region: "CN",
                }}
                onSearch={(cond) => {
                  console.log(cond);
                }}
              />
              <MovieTable results={movies} />
            </div>
          );
        }
        ```

    3. æµ‹è¯•æ•ˆæœ
        ![sdf](./assets/25.png)
        

4. ç¼–å†™åˆ†é¡µç»„ä»¶ï¼Œä½¿ç”¨ä¹‹å‰å·²ç»ç¼–å†™è¿‡çš„é€šç”¨ç»„ä»¶Pager

    1. ä½¿ç”¨ä¹‹å‰ç¼–å†™è¿‡çš„Pagerç»„ä»¶

        ```jsx
        import React from "react";
        import "./Pager.css";
        
        /**
         *
         * @param {*} props
         * currentPage :å½“å‰é¡µæ•°
         * pageNumber :é¡µå®¹é‡
         * totalPage :æ€»é¡µæ•°
         * handerClick :å›è°ƒå‡½æ•°
         * @returns
         */
        export default function Pager(props) {
          const {
            currentPage,
            pageNumber = 10, //è®¾ç½®é»˜è®¤å€¼
            totalPage,
            handerClick,
          } = props;
        
          const min = getMin(currentPage, pageNumber, totalPage);
          const max = getMax(min, pageNumber);
          const pageNumbers = getPageNumbers(min, max);
          if (!totalPage) {
            return null;
          }
          return (
            <div className="container">
              {/* é¦–é¡µ */}
              <span
                className={`pager ${currentPage === 1 ? "disabled" : ""}`}
                onClick={() => {
                  const targetPage = 1;
                  handerClick(targetPage);
                }}
              >
                {"|<<"}
              </span>
              {/* ä¸Šä¸€é¡µ */}
              <span
                className={`pager ${currentPage === 1 ? "disabled" : ""}`}
                onClick={() => {
                  const targetPage = currentPage <= 1 ? 1 : currentPage - 1;
                  handerClick(targetPage);
                }}
              >
                {"<"}
              </span>
              {/* æ•°å­—é¡µ */}
              {pageNumbers.map((page, i) => (
                <span
                  key={i}
                  className={`pager ${currentPage === page ? "active" : ""}`}
                  onClick={() => {
                    const targetPage = page;
                    handerClick(targetPage);
                  }}
                >
                  {page}
                </span>
              ))}
              {/* ä¸‹ä¸€é¡µ */}
              <span
                className={`pager ${currentPage === totalPage ? "disabled" : ""}`}
                onClick={() => {
                  const targetPage =
                    currentPage >= totalPage ? totalPage : currentPage + 1;
                  handerClick(targetPage);
                }}
              >
                {">"}
              </span>
        
              {/* å°¾é¡µ */}
              <span
                className={`pager ${currentPage === totalPage ? "disabled" : ""}`}
                onClick={() => {
                  const targetPage = totalPage;
                  handerClick(targetPage);
                }}
              >
                {">>|"}
              </span>
              <span className="pager show">
                {currentPage} / {totalPage}
              </span>
            </div>
          );
        }
        
        // è¾…åŠ©å‡½æ•°
        function getMin(currentPage, pageNumber, totalPage) {
          let minNumber = currentPage - pageNumber / 2;
          if (minNumber <= 1) {
            minNumber = 1;
          }
          if (minNumber >= totalPage - pageNumber + 1) {
            minNumber = totalPage - pageNumber + 1;
          }
          return minNumber;
        }
        
        function getMax(minNumber, pageNumber) {
          return minNumber + pageNumber - 1;
        }
        function getPageNumbers(minNumber, maxNumber) {
          let pageNumbers = [];
          for (let i = minNumber; i <= maxNumber; i++) {
            pageNumbers.push(i);
          }
          return pageNumbers;
        }
        ```

    2. MovieListç»„ä»¶ä¸­ä½¿ç”¨Pagerç»„ä»¶(ä¸´æ—¶ä½¿ç”¨-æ˜¾ç¤ºç»„ä»¶)

        ```jsx
        import React, { useState, useEffect } from "react";
        import MovieSearchBar from "../../components/MovieSearchBar";
        import MovieTable from "../../components/MovieTable";
        import Pager from "../../common/Pager/FuncPager";
        import { searchMovies } from "../../server/movieAPI";
        
        export default function MovieList() {
          const [movies, setMovies] = useState([]);
          useEffect(() => {
            searchMovies().then((resp) => setMovies(resp.results));
          }, []);
          return (
            <div>
              <MovieSearchBar
                defaultValue={{
                  query: "hello world",
                  langage: "en-US",
                  region: "CN",
                }}
                onSearch={(cond) => {
                  console.log(cond);
                }}
              />
              <MovieTable results={movies} />
              <Pager
                currentPage={1}
                pageNumber={10}
                totalPage={100}
                handerClick={() => console.log(111)}
              />
            </div>
          );
        }
        ```

    3. æµ‹è¯•æ•ˆæœ
        ![sdf](./assets/26.png) 

5. æ•´åˆä¸Šé¢çš„ç»„ä»¶ï¼Œé‡å†™ç¼–å†™MovieListç»„ä»¶

    1. éœ€æ±‚ï¼š

        1. å¸Œæœ›åœ¨åœ°å€æ ä¸­åæ˜ å‡ºæŸ¥è¯¢æ¡ä»¶
        2. å³æˆ‘ä»¬éœ€è¦çš„å¾ˆå¤šçš„æŸ¥è¯¢æ¡ä»¶æ¥è‡ªäºåœ°å€å‚æ•°ï¼Œæ¢å¥è¯è¯´ï¼š**åœ°å€å‚æ•°å˜åŒ–äº†ï¼Œå°±è¦é‡æ–°æŸ¥è¯¢**ï¼›
        3. å¦å¤–ï¼Œç‚¹å‡»æŸ¥è¯¢æŒ‰é’®ï¼Œéœ€è¦æ”¹å˜åœ°å€å‚æ•°

    2. MovieListç»„ä»¶ä¸­çš„æ•°æ®

        1. çŠ¶æ€æ•°æ®ï¼šéœ€è¦è‡ªèº«ç»´æŠ¤çš„çŠ¶æ•°æ®ï¼šæ¯”å¦‚ç”µå½±åˆ—è¡¨æ•°ç»„
        2. å±æ€§æ•°æ®ï¼šæ¥è‡ªåœ°å€æ å‚æ•°â€”â€”ã€‹è·å–åœ°å€æ å‚æ•°ï¼šé€šè¿‡å±æ€§props.locationå¯¹è±¡

    3. ç¼–å†™è¾…åŠ©å‡½æ•°ï¼š

        1. è·å–åœ°å€æ ä¸­æŸ¥è¯¢æ¡ä»¶çš„å‡½æ•°

            ```js
            import { parse } from "query-string";
            /**
             * è¯¥å‡½æ•°ç”¨äºè·å–åœ°å€æ ä¸­çš„æŸ¥è¯¢æ¡ä»¶ï¼Œè¿”å›ä¸€ä¸ªå¯¹è±¡query
             * å¦‚æœæŸäº›æ¡ä»¶åœ¨åœ°å€æ ä¸­ç¡®å®ï¼Œåˆ™ä½¿ç”¨é»˜è®¤å€¼
             * @param {*} search åœ°å€æ å‚æ•°
             */
            function getQuery(search) {
              // å°†åœ°å€æ å‚æ•°è§£æä¸ºä¸€ä¸ªå¯¹è±¡(ä½¿ç”¨ç¬¬ä¸‰æ–¹åº“query-string)
              const query = parse(search);
              return query;
            }
            
            ```

        2. ç»™åœ°å€æ ä¸­æŸ¥è¯¢å¯¹è±¡çš„ç¼ºå¤±é¡¹è®¾ç½®é»˜è®¤å€¼

            ```js
            function getQuery(search) {
              // è®¾ç½®é»˜è®¤å€¼
              const queryDefault = {
                page: 1,
                query: "",
                langage: "en-US",
                region: "CN",
              };
              // å°†åœ°å€æ å‚æ•°è§£æä¸ºä¸€ä¸ªå¯¹è±¡(ä½¿ç”¨ç¬¬ä¸‰æ–¹åº“query-string)
              let query = parse(search);
              // è¿”å›æ··åˆåçš„å¯¹è±¡
              query = Object.assign({}, queryDefault, query);
              query.page = +query.page; // ç±»å‹è½¬æ¢
              return query;
            }
            ```

    4. è‡ªå®šä¹‰hook  ğŸª æ¥ç»´æŠ¤çŠ¶æ€æ•°æ®ï¼ˆç”µå½±åˆ—è¡¨æ•°ç»„ï¼Œé¡µæ•°ï¼‰--ã€‹æœåŠ¡å™¨çš„å“åº”ç»“æœ

        æŸ¥è¯¢æ¡ä»¶å˜åŒ–æ—¶ï¼ŒæœåŠ¡å™¨çš„å“åº”ç»“æœè·Ÿç€å˜åŒ–

        ```jsx
        /**
         * è‡ªå®šä¹‰hookï¼Œæ ¹æ®æŸ¥è¯¢æ¡ä»¶çš„å˜åŒ–ï¼Œè°ƒç”¨æœåŠ¡å™¨ï¼Œè·å–æ–°çš„å“åº”ç»“æœ
         * @param {*} query æŸ¥è¯¢æ¡ä»¶
         * @returns respï¼š æ–°çš„ç›¸åº”ç»“æœ
         */
        function useResp(query) {
          const [resp, setResp] = useState({});
          useEffect(() => {
            searchMovies({
              page: query.page,
              query: query.query,
              language: query.langage,
              region: query.region,
            }).then((r) => {
              setResp(r);
            });
          }, [query.page, query.query, query.langage, query.region]);
          return resp;
        }
        ```

    5. MovieListç»„ä»¶ä¸­ä½¿ç”¨è¾…åŠ©å‡½æ•°getQueryè·å–æŸ¥è¯¢æ¡ä»¶ï¼Œä½¿ç”¨è‡ªå®šä¹‰hookè·å–æœåŠ¡å™¨å“åº”ç»“æœï¼Œå¹¶ä¼ é€’ç›¸åº”ç»“æœä¸­çš„resultsç»™ç»„ä»¶**MovieTable**ï¼Œå¹¶æ›´æ–°ç»„ä»¶**MovieSearchBar**ä¸­ä¼ é€’çš„defaultValue, æ›´æ–°é¡µç Pagerç»„ä»¶

        ```jsx
        export default function MovieList(props) {
          const query = getQuery(props.location.search);
          const resp = useResp(query);
          return (
            <div>
              <MovieSearchBar
                defaultValue={{
                  query: query.query,
                  langage: query.langage,
                  region: query.region,
                }}
                onSearch={(cond) => {
                  console.log(cond);
                }}
              />
        
              <MovieTable results={resp.results} />
        	  <Pager
                currentPage={query.page}
                pageNumber={10}
                totalPage={resp.total_pages}
                handerClick={(newPage) => {
                  console.log(newPage);
                }}
              />
            </div>
          );
        }
        ```

        

    6. æ›´æ–°æŸ¥è¯¢æ¡ä»¶ï¼š

        1. ç‚¹å‡»searchæŒ‰é’®æ—¶è¦é‡æ–°æŸ¥è¯¢ï¼Œç‚¹å‡»é¡µç é¡µé¢æ—¶ä¹Ÿè¦é‡æ–°æŸ¥è¯¢

        2. åŸç†ï¼šé‡æ–°æŸ¥è¯¢å°±è¡Œæ›´æ”¹æŸ¥è¯¢åœ°å€

        3. å®ç°

            1. ç¼–å†™æ”¹å˜æŸ¥è¯¢åœ°å€çš„å‡½æ•°

                ```jsx
                import { parse, stringify } from "query-string";
                /**
                 * æ ¹æ®æŸ¥è¯¢æ¡ä»¶ï¼Œæ”¹å˜æŸ¥è¯¢åœ°å€
                 * @param {*} query æŸ¥è¯¢æ¡ä»¶å¯¹è±¡
                 * @param {*} props ç»„ä»¶å±æ€§
                 */
                const changeLocation = (query, props) => {
                  console.log(query);
                  const search = stringify(query);
                  console.log(search);
                  // æ›´æ–°åœ°å€è·¯å¾„
                  props.history.push("?" + search);
                };
                ```

            2. ç‚¹å‡»æœç´¢æŒ‰é’®æ—¶ï¼Œç”Ÿæˆæ–°çš„æŸ¥è¯¢æ¡ä»¶ï¼Œå¹¶è°ƒç”¨æ”¹å˜æŸ¥è¯¢åœ°å€çš„å‡½æ•°

                ```jsx
                ...
                <MovieSearchBar
                        defaultValue={{
                          query: query.query,
                          langage: query.langage,
                          region: query.region,
                        }}
                        onSearch={(cond) => {
                          const newQuery = {
                            ...query,
                            page: 1,
                            query: cond.query,
                            language: cond.langage,
                            region: cond.region,
                          };
                          changeLocation(newQuery, props);
                        }}
                      />
                ...
                ```

            3. ç‚¹å‡»é¡µç æ—¶ï¼Œç”Ÿæˆæ–°çš„æŸ¥è¯¢æ¡ä»¶ï¼Œå¹¶è°ƒç”¨æ”¹å˜æŸ¥è¯¢åœ°å€çš„å‡½æ•°

                ```jsx
                 ...
                <Pager
                            currentPage={query.page}
                            // pageNumber={10}
                            totalPage={resp.total_pages}
                            handerClick={(newPage) => {
                              const newQuery = {
                                ...query,
                                page: newPage,
                              };
                              changeLocation(newQuery, props);
                            }}
                          />
                ...
                ```

                

    7.  MovieListç»„ä»¶æœ€ç»ˆé¡µé¢

        ```jsx
        import React, { useState, useEffect } from "react";
        import MovieSearchBar from "../../components/MovieSearchBar";
        import MovieTable from "../../components/MovieTable";
        import Pager from "../../common/Pager/FuncPager";
        import { searchMovies } from "../../server/movieAPI";
        import { parse, stringify } from "query-string";
        /**
         * è¯¥å‡½æ•°ç”¨äºè·å–åœ°å€æ ä¸­çš„æŸ¥è¯¢æ¡ä»¶ï¼Œè¿”å›ä¸€ä¸ªå¯¹è±¡query
         * å¦‚æœæŸäº›æ¡ä»¶åœ¨åœ°å€æ ä¸­ç¡®å®ï¼Œåˆ™ä½¿ç”¨é»˜è®¤å€¼
         * @param {*} search åœ°å€æ å‚æ•°
         */
        function getQuery(search) {
          // è®¾ç½®é»˜è®¤å€¼
          const queryDefault = {
            page: 1,
            query: "",
            langage: "en-US",
            region: "CN",
          };
          // å°†åœ°å€æ å‚æ•°è§£æä¸ºä¸€ä¸ªå¯¹è±¡(ä½¿ç”¨ç¬¬ä¸‰æ–¹åº“query-string)
          let query = parse(search);
          // è¿”å›æ··åˆåçš„å¯¹è±¡
          query = Object.assign({}, queryDefault, query);
          query.page = +query.page; // ç±»å‹è½¬æ¢
          return query;
        }
        /**
         * è‡ªå®šä¹‰hookï¼Œæ ¹æ®æŸ¥è¯¢æ¡ä»¶çš„å˜åŒ–ï¼Œè°ƒç”¨æœåŠ¡å™¨ï¼Œè·å–æ–°çš„å“åº”ç»“æœ
         * @param {*} query æŸ¥è¯¢æ¡ä»¶
         * @returns respï¼š æ–°çš„ç›¸åº”ç»“æœ
         */
        function useResp(query) {
          const [resp, setResp] = useState({ total_pages: 0, results: [] });
          useEffect(() => {
            searchMovies({
              page: query.page,
              query: query.query,
              language: query.langage,
              region: query.region,
            }).then((r) => {
              setResp(r);
            });
          }, [query.page, query.query, query.langage, query.region]);
          return resp;
        }
        /**
         * æ ¹æ®æŸ¥è¯¢æ¡ä»¶ï¼Œæ”¹å˜æŸ¥è¯¢åœ°å€
         * @param {*} query æŸ¥è¯¢æ¡ä»¶å¯¹è±¡
         * @param {*} props ç»„ä»¶å±æ€§
         */
        const changeLocation = (query, props) => {
          console.log(query);
          const search = stringify(query);
          console.log(search);
          // æ›´æ–°åœ°å€è·¯å¾„
          props.history.push("?" + search);
        };
        
        export default function MovieList(props) {
          const query = getQuery(props.location.search);
          const resp = useResp(query);
          return (
            <div>
              <MovieSearchBar
                defaultValue={{
                  query: query.query,
                  langage: query.langage,
                  region: query.region,
                }}
                onSearch={(cond) => {
                  const newQuery = {
                    ...query,
                    page: 1,
                    query: cond.query,
                    language: cond.langage,
                    region: cond.region,
                  };
                  changeLocation(newQuery, props);
                }}
              />
              {resp.results.length > 0 ? (
                <>
                  <MovieTable results={resp.results} />
                  <Pager
                    currentPage={query.page}
                    // pageNumber={10}
                    totalPage={resp.total_pages}
                    handerClick={(newPage) => {
                      const newQuery = {
                        ...query,
                        page: newPage,
                      };
                      changeLocation(newQuery, props);
                    }}
                  />
                </>
              ) : (
                <p style={{ color: "red" }}> No Results</p>
              )}
            </div>
          );
        }
        
        ```
        ![sdf](./assets/27.png)
        
        
        

6. è¯¦æƒ…ç»„ä»¶...

    1. æ€è·¯ï¼š

        1. MovieTableç»„ä»¶ä¸­çš„æ“ä½œé¡¹ï¼Œä½¿ç”¨Linkç»„ä»¶``<Link to={`/students/${m.id}`}>è¯¦æƒ…</Link>``ï¼Œè®¾ç½®åœ°å€è·¯å¾„
        2. è·¯ç”±ç»„ä»¶ä¸­ä½¿ç”¨`<**Route** path**=**"/students/:id" exact component**=**{MovieDetail} />`, è¿›è¡Œè·¯å¾„åŒ¹é…ç»„ä»¶
        3. è¯¦æƒ…ç»„ä»¶ä¸­ä½¿ç”¨`props.match.params`å¯¹è±¡è·å–idå±æ€§
        4. åœ¨ä½¿ç”¨è·å–åˆ°çš„idï¼Œè°ƒç”¨æœåŠ¡å™¨ç«¯å£ï¼Œè·å–movieè¯¦æƒ…
        5. å°†movieå¯¹è±¡ä¼ é€’ç»™Movieç»„ä»¶è¿›è¡Œæ¸²æŸ“

    2. ç¼–å†™æœåŠ¡å™¨ç«¯å£API

        ```jsx
        export async function getMoviesDetail(id) {
          const res = await axios.get(`/3/movie/${id}`, {
            headers: { Authorization: "Bearer " + TOKEN },
          });
          return res.data;
        }
        ```

    3. MovieTableç»„ä»¶,æ·»åŠ Linkç»„ä»¶ï¼Œè¿›è¡Œè·¯å¾„è·³è½¬

        ```jsx
        import React from "react";
        import "./index.css";
        import { Link } from "react-router-dom";
        
        export default function MovieTable(props) {
          const trs = props.results.map((m) => (
            <tr key={m.id}>
            ...
              <td>
                <Link to={`/students/${m.id}`}>è¯¦æƒ…</Link>
              </td>
            </tr>
          ));
        
          return (
            <table className="table">
           ...
            </table>
          );
        }
        ```

    4. è·¯ç”±ç»„ä»¶ä¸­æ·»åŠ æ–°çš„è·¯ç”±é¡¹

        ```jsx
        ...
        import MovieDetail from "../../components/MovieDetial";
        
        export default function Admin() {
          return (
            <Layout header={<Header />} aside={<Menu />}>
              {/* {"children "} */}
              <Switch>
                <Route path="/" exact component={Welcome} />
                <Route path="/students" exact component={MovieList} />
                <Route path="/students/add" exact component={MovieAdd} />
                <Route path="/students/:id" exact component={MovieDetail} />
        			...
              </Switch>
            </Layout>
          );
        }
        ```

        

    5. ç¼–å†™MovieDetailç»„ä»¶ï¼Œ ç¼–å†™è‡ªå®šä¹‰hookï¼Œä»æœåŠ¡ç«¯æ¥å£ä¸­è·å–æ•°æ®

        ```jsx
        import React, { useState, useEffect } from "react";
        import { getMoviesDetail } from "../../server/movieAPI";
        import Movie from "../MovieList/Movie";
        import "./index.css";
        
        function useMovieById(id) {
          const [movie, setMovie] = useState(null);
          // æ³¨æ„ï¼šå¯¹è±¡çš„åˆå§‹å€¼è®¾ä¸ºnullï¼Œè€Œä¸æ˜¯ç©ºå¯¹è±¡
          // åˆå§‹å€¼è®¾ä¸ºç©ºå¯¹è±¡çš„è¯ï¼Œä¼šå¼•èµ·ä½¿ç”¨å¯¹è±¡å±æ€§æ˜¯undefinedçš„é”™è¯¯
          useEffect(() => {
            getMoviesDetail(id).then((resp) => {
              setMovie(resp);
            });
          }, [id]);
          return movie;
        }
        
        export default function MovieDetail(props) {
          const movieID = +props.match.params.id;
          const movie = useMovieById(movieID);
          console.log(movie);
        
          return (
            <div>
              <header className="detail_header">
                <h1>MovieDetail</h1>
              </header>
              <div className="detail_container">
                {/* å¦‚æœmovieæ•°æ®å°šæœªåŠ è½½å®Œæˆï¼Œè¿”å›ä¸€ä¸ªåŠ è½½æŒ‡ç¤ºå™¨æˆ–ç©ºå…ƒç´  */}
                {movie ? <Movie movie={movie} /> : <div>Loading...</div>}
              </div>
            </div>
          );
        }
        ```

    6. æ ·å¼éƒ¨åˆ†ï¼Œçœç•¥

    7. æµ‹è¯•æ•ˆæœ

        ![sdf](./assets/28.png)
        
        ç‚¹å‡»è¯¦æƒ…å        
        ![sdf](./assets/29.png)        